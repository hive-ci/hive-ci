<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Device API</title>
  <meta name="description" content="Device API is a collection of gems that make working with physical devices easy and consistent. It provides common utilities such as device detection and ide...">

  <link rel="stylesheet" href="/hive-ci/css/main.css">
  <link rel="canonical" href="http://localhost:4000/hive-ci/documentation/device_api.html">
  <link rel="alternate" type="application/rss+xml" title="Hive CI | CI for device testing" href="http://localhost:4000/hive-ci/feed.xml" />
</head>



  <body>
    <div class="site-wrapper page-image">

      <a id='top-of-page'></a>
      <nav class="navbar navbar-default navbar-fixed-topx">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="/hive-ci/index.html">
        <img src="/hive-ci/images/hive-ci-simple.png" class="nav-logo pull-left" alt="Hive CI interface">
      </a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        
        
        
        <li class="">
          <a class="" href="/hive-ci/index.html">Home</a>
        </li>
        
        
        
        <li class="">
          <a class="" href="/hive-ci/hive-ci.html">Hive CI</a>
        </li>
        
        
        
        <li class="">
          <a class="" href="/hive-ci/hive-runner.html">Hive Runner</a>
        </li>
        
        
        
        <li class="">
          <a class="" href="/hive-ci/hivemind.html">Hive Mind</a>
        </li>
        
        
        
        <li class="">
          <a class="" href="/hive-ci/testmine.html">Test Mine</a>
        </li>
        
        
        
        <li class="">
          <a class="" href="/hive-ci/test-tools.html">Test Tools</a>
        </li>
        
        
        
        <li class="">
          <a class="" href="/hive-ci/documentation/hive-ci.html">Info</a>
        </li>
        
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>



      <div class="row">

      <div class="page-content">
        <div class="col-xs-12 col-sm-2">
          <ul class="nav nav-pills nav-stacked nav-compact">
            
              <li role="presentation">
                
                  <a href="/hive-ci/documentation/hive-ci.html">Introduction</a>
                
              </li>
            
              <li role="presentation">
                
                  <a href="/hive-ci/documentation/overview.html">Overview</a>
                
              </li>
            
              <li role="presentation">
                
                  <a href="/hive-ci/documentation/setting-up-a-hive.html">Setting up a Hive</a>
                
              </li>
            
              <li role="presentation">
                
                  <a href="/hive-ci/documentation/quick-start.html"> + Quick Start Guide</a>
                
              </li>
            
              <li role="presentation">
                
                  <a href="/hive-ci/documentation/best-practices.html"> + Best Practices</a>
                
              </li>
            
              <li role="presentation">
                
                  <a href="/hive-ci/documentation/examples.html"> + Examples</a>
                
              </li>
            
              <li role="presentation">
                
                  <a href="/hive-ci/documentation/plugins-and-components.html">Plugins</a>
                
              </li>
            
              <li role="presentation">
                
                  <a href="/hive-ci/documentation/android_plugin.html"> + Android Plugin</a>
                
              </li>
            
              <li role="presentation">
                
                  <a href="/hive-ci/documentation/ios_plugin.html"> + iOS Plugin</a>
                
              </li>
            
              <li role="presentation">
                
                  <a href="/hive-ci/documentation/tv_plugin.html"> + TV Plugin</a>
                
              </li>
            
              <li role="presentation">
                
                  <a href="/hive-ci/documentation/device_api.html"> + Device API</a>
                
              </li>
            
              <li role="presentation">
                
                  <a href="/hive-ci/documentation/software-links.html">Software Links</a>
                
              </li>
            
              <li role="presentation">
                
                  <a href="/hive-ci/documentation/glossary.html">Glossary</a>
                
              </li>
            
              <li role="presentation">
                
                  <a href="/hive-ci/documentation/faq.html">FAQ</a>
                
              </li>
            
          </ul>
        </div>


        <div class="col-xs-12  col-sm-9">
        <h1>Device API</h1>
        <p class="lead">Device API is a collection of gems that make working with physical devices easy and consistent. It provides common utilities such as device detection and identification, and useful helpers for installing applications and identifying problems with devices. It is used by the Hive Runner but can be used in other projects.</p>

<h2 id="contents">Contents</h2>
<ul>
  <li><a href="#basic-usage">Basic usage</a></li>
  <li><a href="#connecting-to-devices">Connecting to devices</a></li>
  <li><a href="#other-device-commands">Other device commands</a></li>
</ul>

<h2 id="basic-usage">Basic Usage</h2>

<p>Currently Device API supports Android and iOS mobile devices. To install, add</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">gem</span> <span class="s1">'device_api-android'</span>

<span class="c1"># or</span>

<span class="n">gem</span> <span class="s1">'device_api-ios'</span>
</code></pre>
</div>

<p>to the <code class="highlighter-rouge">Gemfile</code> of your project. To detect all connected devices use</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="nb">require</span> <span class="s1">'device_api/android'</span>
<span class="n">devices</span> <span class="o">=</span> <span class="no">DeviceAPI</span><span class="o">::</span><span class="no">Android</span><span class="p">.</span><span class="nf">devices</span>

<span class="c1"># or</span>

<span class="nb">require</span> <span class="s1">'device_api/ios'</span>
<span class="n">devices</span> <span class="o">=</span> <span class="no">DeviceAPI</span><span class="o">::</span><span class="no">IOS</span><span class="p">.</span><span class="nf">devices</span>
</code></pre>
</div>

<p>To get a list of the model and OS version of all attached devices:</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">devices</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">d</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="s2">"</span><span class="si">#{</span><span class="n">d</span><span class="p">.</span><span class="nf">serial</span><span class="si">}</span><span class="s2">:"</span>
  <span class="nb">puts</span> <span class="s2">"  Model </span><span class="si">#{</span><span class="n">d</span><span class="p">.</span><span class="nf">model</span><span class="si">}</span><span class="s2">"</span>
  <span class="nb">puts</span> <span class="s2">"  OS Version </span><span class="si">#{</span><span class="n">d</span><span class="p">.</span><span class="nf">version</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span>
</code></pre>
</div>

<h2 id="connecting-to-devices">Connecting to devices</h2>

<p>A device object can be created from its <strong>qualifier</strong>:</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">device</span> <span class="o">=</span> <span class="no">DeviceAPI</span><span class="o">::</span><span class="no">Android</span><span class="p">.</span><span class="nf">device</span><span class="p">(</span> <span class="n">qualifier</span> <span class="p">)</span>
<span class="n">device</span> <span class="o">=</span> <span class="no">DeviceAPI</span><span class="o">::</span><span class="no">IOS</span><span class="p">.</span><span class="nf">device</span><span class="p">(</span> <span class="n">qualifier</span> <span class="p">)</span>
</code></pre>
</div>

<p>For iOS the qualifier is the device UDID as found in iTunes or XCode.</p>

<p>For Android the qualifier is the serial number for devices connected over USB
or the the IP address together with port number (default 5555) for devices
connected over the network. This is shown by <code class="highlighter-rouge">adb devices</code>.</p>

<p>Alternatively, an array of all device objects can be created:</p>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="n">devices</span> <span class="o">=</span> <span class="no">DeviceAPI</span><span class="o">::</span><span class="no">Android</span><span class="p">.</span><span class="nf">devices</span>
<span class="n">devices</span> <span class="o">=</span> <span class="no">DeviceAPI</span><span class="o">::</span><span class="no">IOS</span><span class="p">.</span><span class="nf">devices</span>
</code></pre>
</div>

<h2 id="other-device-commands">Other Device Commands</h2>

<div class="language-ruby highlighter-rouge"><pre class="highlight"><code><span class="c1"># Show serial number (Android) or UDID (iOS)</span>
<span class="n">device</span><span class="p">.</span><span class="nf">serial</span>
<span class="n">device</span><span class="p">.</span><span class="nf">serial_no</span>        <span class="c1"># Alternative for Android only</span>

<span class="c1"># Show status</span>
<span class="n">device</span><span class="p">.</span><span class="nf">status</span>

<span class="c1"># Show device qualifier</span>
<span class="n">device</span><span class="p">.</span><span class="nf">qualifier</span>
<span class="c1"># Android -&gt; Serial number or IP address plus port 5555</span>
<span class="c1"># iOS     -&gt; UDID</span>

<span class="c1"># Get device name</span>
<span class="c1"># TODO: Make consistent</span>
<span class="n">device</span><span class="p">.</span><span class="nf">device</span>           <span class="c1"># Android</span>
<span class="n">device</span><span class="p">.</span><span class="nf">name</span>             <span class="c1"># iOS</span>

<span class="c1"># Get device make and model</span>
<span class="n">device</span><span class="p">.</span><span class="nf">model</span>
<span class="n">device</span><span class="p">.</span><span class="nf">manufacturer</span>     <span class="c1"># Android only</span>

<span class="c1"># Get OS version</span>
<span class="n">device</span><span class="p">.</span><span class="nf">version</span>

<span class="c1"># Get IP address</span>
<span class="n">device</span><span class="p">.</span><span class="nf">ip_address</span>       <span class="c1"># Helper app needs to be installed for iOS</span>

<span class="c1"># Get MAC address</span>
<span class="n">device</span><span class="p">.</span><span class="nf">wifi_mac_address</span> <span class="c1"># Unavailable for Android 6.0 and later</span>

<span class="c1"># Get IMEI</span>
<span class="n">device</span><span class="p">.</span><span class="nf">imei</span>

<span class="c1"># Show installed packages</span>
<span class="c1"># TODO: Make the output consistent between Android and iOS</span>
<span class="n">device</span><span class="p">.</span><span class="nf">list_installed_packages</span>

<span class="c1"># Install/uninstall package</span>
<span class="n">device</span><span class="p">.</span><span class="nf">install</span><span class="p">(</span> <span class="n">package_file</span> <span class="p">)</span>
<span class="n">device</span><span class="p">.</span><span class="nf">uninstall</span><span class="p">(</span> <span class="n">package_name</span> <span class="p">)</span>

<span class="c1"># Take a screenshot</span>
<span class="n">device</span><span class="p">.</span><span class="nf">screenshot</span><span class="p">(</span> <span class="ss">filename: </span><span class="n">filename</span> <span class="p">)</span>

<span class="c1"># Reboot</span>
<span class="n">device</span><span class="p">.</span><span class="nf">reboot</span>
<span class="n">device</span><span class="p">.</span><span class="nf">restart</span>
</code></pre>
</div>

        <p><a href='#top-of-page'>Top</a></p>
        </div>
      </div>
      </div>

      <div class="row">
<div class="col-xs-span-10 footer">
  <p>BBC Hive is an Open Source BBC project licensed under MIT</p>
  <p>This site is built with Jekyll and Bootstrap, and hosted on GitHub pages.</p>
  <p><strong>&copy; 2015 BBC</strong></p>
</div>
</div>



    </div>


        <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="/hive-ci/js/bootstrap.min.js">
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="/hive-ci/js/ie10-viewport-bug-workaround.js"></script>
    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63228527-1', 'auto');
  ga('send', 'pageview');

</script>


  </body>
</html>
